<!doctype html>
<html lang="bg">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>AIRV â€” CLASSIFIED REMOTE VIEWING TERMINAL</title>
<style>
  :root {
    --bg: #050705;
    --panel: #0a0c0a;
    --line: #1a2a1a;
    --green: #00ff41; /* Classic Matrix/Terminal Green */
    --green-dim: #008f11;
    --red: #ff3131;
    --amber: #ffb000;
    --txt: #d1ffd1;
    --mono: "Courier New", Courier, monospace;
  }

  * { box-sizing: border-box; cursor: crosshair; }
  body { 
    margin: 0; background: var(--bg); color: var(--txt); 
    font: 13px/1.2 var(--mono); text-transform: uppercase;
    overflow-x: hidden;
  }

  /* CRT Scanline Effect */
  body::before {
    content: " "; display: block; position: fixed; top: 0; left: 0; bottom: 0; right: 0;
    background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
    z-index: 1000; pointer-events: none; background-size: 100% 2px, 3px 100%;
  }

  .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
  .grid { display: grid; gap: 15px; }
  .g3 { grid-template-columns: 300px 1fr 300px; }
  
  .panel { 
    background: var(--panel); border: 1px solid var(--line); 
    padding: 15px; position: relative;
    box-shadow: 0 0 15px rgba(0, 255, 65, 0.05);
  }

  .panel::before {
    content: "SECURED_CONNECTION"; position: absolute; top: -8px; left: 10px;
    background: var(--bg); font-size: 9px; padding: 0 5px; color: var(--green-dim);
  }

  h3.title { 
    color: var(--green); border-bottom: 1px solid var(--green-dim); 
    padding-bottom: 5px; margin-top: 0; font-size: 14px; letter-spacing: 2px;
  }

  input, textarea, select {
    background: #000; border: 1px solid var(--line); color: var(--green);
    padding: 8px; font: 13px var(--mono); width: 100%; outline: none;
  }

  input:focus, textarea:focus { border-color: var(--green); box-shadow: 0 0 5px var(--green-dim); }

  .btn {
    background: transparent; border: 1px solid var(--green-dim); color: var(--green-dim);
    padding: 6px 12px; cursor: pointer; transition: 0.2s;
  }

  .btn:hover { background: var(--green-dim); color: #000; box-shadow: 0 0 10px var(--green); }
  .btn.active { color: var(--green); border-color: var(--green); }

  .matrix-grid { 
    display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; 
    margin-top: 10px;
  }

  canvas.sk { background: #000; border: 1px solid var(--line); width: 100%; touch-action: none; }
  
  .status-bar { border-top: 1px solid var(--line); padding: 5px; font-size: 10px; display: flex; gap: 20px; }
  .crt-text { text-shadow: 0 0 8px var(--green-dim); }
  
  #log { height: 200px; overflow-y: auto; font-size: 11px; color: var(--green-dim); }
  .hidden { display: none; }

  /* Stage specific layouts */
  .s4-col { display: flex; flex-direction: column; gap: 5px; }
  .s4-col label { font-size: 10px; color: var(--green-dim); text-align: center; }
</style>
</head>
<body>

<div class="container">
  <div class="panel" style="margin-bottom: 15px;">
    <div style="display:flex; justify-content: space-between; align-items: center;">
      <h1 class="crt-text" style="margin:0; font-size: 20px; color: var(--green);">STARGATE SYSTEM // AIRV-PRO v2.0</h1>
      <div id="clock" class="amber">00:00:00</div>
    </div>
  </div>

  <div class="grid g3">
    <div class="panel">
      <h3 class="title">I. OPERATION_DATA</h3>
      <div class="grid">
        <label>VIEWER_ID: <input type="text" id="viewer" value="V-099"/></label>
        <label>COORDINATES: <div style="display:flex; gap:5px;">
          <input type="text" id="trn" readonly placeholder="0000-0000"/>
          <button class="btn" onclick="generateTRN()">NEW</button>
        </div></label>
        <div class="status-bar">
          <span>ST: <b id="st-val">IDLE</b></span>
          <span>RD: <b id="rd-val">0</b></span>
        </div>
      </div>
      
      <div style="margin-top:20px;" class="grid">
        <button class="btn" onclick="changeStage('S1')">STAGE I: IDEOGRAM</button>
        <button class="btn" onclick="changeStage('S2')">STAGE II: SENSORY</button>
        <button class="btn" onclick="changeStage('S3')">STAGE III: SKETCH</button>
        <button class="btn" onclick="changeStage('S4')">STAGE IV: MATRIX</button>
        <button class="btn" onclick="changeStage('S5')">STAGE V: INTERROG.</button>
        <button class="btn" onclick="changeStage('S6')">STAGE VI: MODEL</button>
      </div>
    </div>

    <div class="panel" id="work-area">
      <h3 class="title" id="stage-title">INITIALIZING...</h3>
      <div id="stage-content">
        </div>
    </div>

    <div class="panel">
      <h3 class="title">II. INTEL_LOG</h3>
      <div id="log"></div>
      <div class="divider" style="margin: 10px 0; border-top: 1px solid var(--line);"></div>
      <button class="btn" style="width:100%" onclick="exportReport()">GENERATE REPORT</button>
      <button class="btn red" style="width:100%; margin-top:5px; border-color:var(--red); color:var(--red);" onclick="resetSession()">PURGE SESSION</button>
    </div>
  </div>
</div>

<script>
  // STATE MANAGEMENT
  let state = {
    viewer: "V-099",
    trn: "",
    stage: "IDLE",
    round: 0,
    data: {
      s1: { ideogram: null, i: "", a: "", b: "" },
      s2: [],
      s3: { sketch: null, moves: [] },
      s4: { s: "", d: "", ai: "", ei: "", t: "", it: "", aol: "" },
      s5: "",
      s6: ""
    }
  };

  function log(msg, type="info") {
    const l = document.getElementById('log');
    const time = new Date().toLocaleTimeString().split(' ')[0];
    l.innerHTML = `<div>[${time}] <span class="${type}">${msg}</span></div>` + l.innerHTML;
  }

  function generateTRN() {
    state.trn = `${Math.floor(1000+Math.random()*8999)}-${Math.floor(1000+Math.random()*8999)}`;
    document.getElementById('trn').value = state.trn;
    log(`NEW COORDINATES ASSIGNED: ${state.trn}`, 'amber');
  }

  function changeStage(s) {
    state.stage = s;
    state.round++;
    document.getElementById('st-val').textContent = s;
    document.getElementById('rd-val').textContent = state.round;
    renderStage();
  }

  function renderStage() {
    const area = document.getElementById('stage-content');
    const title = document.getElementById('stage-title');
    title.textContent = `PROTOCOL: ${state.stage}`;
    area.innerHTML = "";

    switch(state.stage) {
      case 'S1':
        area.innerHTML = `
          <p class="green-dim">S1: SPONTANEOUS IDEOGRAM & GESTALT</p>
          <canvas id="s1-cvs" class="sk" height="200"></canvas>
          <div class="grid" style="grid-template-columns: 1fr 1fr 1fr; margin-top: 10px;">
            <input type="text" id="s1i" placeholder="I (Incline/Curve)" onchange="saveS1()">
            <input type="text" id="s1a" placeholder="A (Motion/Texture)" onchange="saveS1()">
            <input type="text" id="s1b" placeholder="B (Gestalt/Object)" onchange="saveS1()">
          </div>
          <button class="btn" style="margin-top:10px" onclick="clearCvs('s1-cvs')">CLEAR CANVAS</button>
        `;
        initCanvas('s1-cvs');
        break;

      case 'S2':
        area.innerHTML = `
          <p class="green-dim">S2: SENSORY DATA (COLORS, TEXTURES, TEMPERATURES)</p>
          <textarea id="s2data" style="height:200px" placeholder="Enter sensory perceptions... (e.g. Rough, cold, blue, metallic smell)" onchange="saveS2()">${state.data.s2}</textarea>
        `;
        break;

      case 'S4':
        area.innerHTML = `
          <p class="green-dim">S4: ANALYTICAL MATRIX (DIA STANDARD)</p>
          <div class="matrix-grid">
            <div class="s4-col"><label>S</label><textarea id="m-s">${state.data.s4.s}</textarea></div>
            <div class="s4-col"><label>D</label><textarea id="m-d">${state.data.s4.d}</textarea></div>
            <div class="s4-col"><label>AI</label><textarea id="m-ai">${state.data.s4.ai}</textarea></div>
            <div class="s4-col"><label>EI</label><textarea id="m-ei">${state.data.s4.ei}</textarea></div>
            <div class="s4-col"><label>T</label><textarea id="m-t">${state.data.s4.t}</textarea></div>
            <div class="s4-col"><label>IT</label><textarea id="m-it">${state.data.s4.it}</textarea></div>
            <div class="s4-col"><label>AOL/S</label><textarea id="m-aol" style="border-color:var(--amber)">${state.data.s4.aol}</textarea></div>
          </div>
          <button class="btn" style="margin-top:10px" onclick="saveS4()">LOCK MATRIX DATA</button>
        `;
        break;

      default:
        area.innerHTML = `<div class="term">READY FOR INPUT. SELECT STAGE TO START PROTOCOL.</div>`;
    }
  }

  // CANVAS LOGIC
  function initCanvas(id) {
    const cvs = document.getElementById(id);
    const ctx = cvs.getContext('2d');
    let drawing = false;
    ctx.strokeStyle = "#00ff41";
    ctx.lineWidth = 2;

    cvs.onmousedown = (e) => { drawing = true; ctx.beginPath(); ctx.moveTo(e.offsetX, e.offsetY); };
    cvs.onmousemove = (e) => { if(drawing) { ctx.lineTo(e.offsetX, e.offsetY); ctx.stroke(); } };
    window.onmouseup = () => { drawing = false; };
  }

  function clearCvs(id) {
    const cvs = document.getElementById(id);
    cvs.getContext('2d').clearRect(0,0,cvs.width,cvs.height);
  }

  // DATA SAVING
  function saveS2() { state.data.s2 = document.getElementById('s2data').value; log("S2 DATA SAVED"); }
  function saveS4() {
    state.data.s4 = {
      s: document.getElementById('m-s').value,
      d: document.getElementById('m-d').value,
      ai: document.getElementById('m-ai').value,
      ei: document.getElementById('m-ei').value,
      t: document.getElementById('m-t').value,
      it: document.getElementById('m-it').value,
      aol: document.getElementById('m-aol').value,
    };
    log("S4 MATRIX UPDATED", "ok");
  }

  function exportReport() {
    let report = `--- CLASSIFIED INTEL REPORT ---\n`;
    report += `VIEWER: ${state.viewer} | TRN: ${state.trn}\n`;
    report += `STAGE 2 SENSORY: ${state.data.s2}\n`;
    report += `STAGE 4 MATRIX:\n [S]: ${state.data.s4.s}\n [D]: ${state.data.s4.d}\n [AOL]: ${state.data.s4.aol}\n`;
    report += `--- END OF REPORT ---`;
    
    const win = window.open("", "_blank");
    win.document.write(`<pre style="background:#000; color:#00ff41; padding:20px;">${report}</pre>`);
    log("REPORT GENERATED IN NEW WINDOW");
  }

  // UTILS
  setInterval(() => {
    document.getElementById('clock').textContent = new Date().toLocaleTimeString('en-GB');
  }, 1000);

  function resetSession() {
    if(confirm("CONFIRM DATA PURGE?")) {
      location.reload();
    }
  }

  window.onload = () => {
    log("SYSTEM ONLINE. WAITING FOR TRN...");
    renderStage();
  };
</script>

</body>
</html>
